<view class="container"><block wx:if="{{post._id}}"><block><view class="post-content"><view class="author"><image class="avatar" src="{{post.author&&post.author.avatar||'/static/images/default-avatar.png'}}" mode="aspectFill" data-event-opts="{{[['tap',[['goToUser',[post.author&&post.author._id]]]]]}}" bindtap="__e"></image><view class="info"><text class="nickname">{{post.author&&post.author.nickname||"美食家"}}</text><text class="time">{{$root.m0}}</text></view><block wx:if="{{post.author&&post.author._id!==currentUser._id}}"><block><button data-event-opts="{{[['tap',[['handleFollow',['$event']]]]]}}" class="{{['follow-btn',(isFollowing)?'following':'']}}" bindtap="__e">{{''+(isFollowing?"已关注":"关注")+''}}</button></block></block></view><text class="title">{{post.title}}</text><text class="description">{{post.description}}</text><block wx:if="{{$root.g0}}"><block><view class="images"><block wx:for="{{post.images}}" wx:for-item="image" wx:for-index="index" wx:key="index"><image src="{{image}}" mode="widthFix" data-event-opts="{{[['tap',[['previewImage',[index]]]]]}}" bindtap="__e"></image></block></view></block></block><block wx:if="{{$root.g1}}"><block><view class="tags"><block wx:for="{{post.tags}}" wx:for-item="tag" wx:for-index="__i0__" wx:key="*this"><text data-event-opts="{{[['tap',[['goToTagPosts',['$0'],[[['post.tags','',__i0__]]]]]]]}}" class="tag" bindtap="__e">{{'#'+tag+''}}</text></block></view></block></block><block wx:if="{{post.location}}"><block><view class="location"><text class="iconfont icon-location"></text><text>{{post.location}}</text></view></block></block></view></block></block><view class="comments"><view class="section-title">{{"评论 "+(post.commentCount||0)}}</view><view class="comment-list"><block wx:if="{{$root.g2}}"><block><block wx:for="{{$root.l0}}" wx:for-item="comment" wx:for-index="__i1__" wx:key="_id"><view class="comment-item"><image class="avatar" src="{{comment.$orig.user&&comment.$orig.user.avatar||'/static/images/default-avatar.png'}}" mode="aspectFill"></image><view class="content"><text class="nickname">{{comment.$orig.user&&comment.$orig.user.nickname}}</text><text class="text">{{comment.$orig.content}}</text><text class="time">{{comment.m1}}</text></view></view></block></block></block><block wx:else><view class="empty">暂无评论</view></block></view></view><view class="action-bar"><view class="comment-input"><input type="text" placeholder="说点什么..." data-event-opts="{{[['confirm',[['submitComment',['$event']]]],['input',[['__set_model',['','commentText','$event',[]]]]]]}}" value="{{commentText}}" bindconfirm="__e" bindinput="__e"/></view><view class="actions"><view data-event-opts="{{[['tap',[['handleLike',['$event']]]]]}}" class="action-item" bindtap="__e"><text class="{{['iconfont',isLiked?'icon-heart-fill':'icon-heart']}}" style="{{'color:'+(isLiked?'#ff6b6b':'#999')+';'}}"></text><text class="count">{{post.likeCount||0}}</text></view><view data-event-opts="{{[['tap',[['handleCollect',['$event']]]]]}}" class="action-item" bindtap="__e"><text class="{{['iconfont',isCollected?'icon-star-fill':'icon-star']}}" style="{{'color:'+(isCollected?'#ff6b6b':'#999')+';'}}"></text><text class="count">{{post.collectCount||0}}</text></view><view data-event-opts="{{[['tap',[['handleShare',['$event']]]]]}}" class="action-item" bindtap="__e"><text class="iconfont icon-share"></text><text class="count">分享</text></view></view></view></view>